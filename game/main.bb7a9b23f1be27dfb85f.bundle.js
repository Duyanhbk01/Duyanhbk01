/*! For license information please see main.bb7a9b23f1be27dfb85f.bundle.js.LICENSE.txt */
(()=>{var e,t={843:(e,t,i)=>{"use strict";i(260);class r extends Phaser.Renderer.WebGL.Pipelines.MultiPipeline{constructor(e){super({game:e,fragShader:"\nprecision mediump float;\n\nuniform sampler2D uMainSampler[%count%];\nuniform float gray;\n\nvarying vec2 outTexCoord;\nvarying float outTexId;\nvarying vec4 outTint;\nvarying vec2 fragCoord;\n\nvoid main()\n{\n    vec4 texture;\n\n    %forloop%\n\n    gl_FragColor = texture;\n    gl_FragColor.rgb = mix(gl_FragColor.rgb, vec3(0.2126 * gl_FragColor.r + 0.7152 * gl_FragColor.g + 0.0722 * gl_FragColor.b), gray);\n}\n",uniforms:["uProjectionMatrix","uMainSampler","gray"]}),this._gray=1}onPreRender(){this.set1f("gray",this._gray)}get gray(){return this._gray}set gray(e){this._gray=e}}class s{constructor(e,t){this.scene=e,this.imageGame=new Phaser.GameObjects.Image(this.scene,0,0,t).setScale(1).setOrigin(0,0),this.createArrayColor()}createArrayColor(){let e=Math.round(this.imageGame.width/1),t=Math.round(this.imageGame.height/1);this.arrayColor=new Array,this.totalTileOfColor=new Array;for(let i=0;i<e;i++)for(let e=0;e<t;e++){let t=this.scene.textures.getPixel(1*i,1*e,this.imageGame.texture.key);if(-1==this.arrayColor.indexOf(t.color)){if(0==t.color)continue;this.arrayColor.push(t.color),this.totalTileOfColor[this.totalTileOfColor.length]=1}else{let e=this.arrayColor.indexOf(t.color);this.totalTileOfColor[e]+=1}}}getArrayColor(){return this.arrayColor}getColorAfterGrayScale(e){let t=this.numberToColour(this.arrayColor[e]),i=this.rgb2grayscale(t[0],t[1],t[2]);return(i<<16)+(i<<8)+i}numberToColour(e){return[(16711680&e)>>16,(65280&e)>>8,255&e]}LightenDarkenColor(e,t){return(255&e)+t|(e>>8&255)+t<<8|(e>>16)+t<<16}rgb2grayscale(e,t,i){return.3*e+.59*t+.11*i}getImageGame(){return this.imageGame}getTotalTileOfColor(){return this.totalTileOfColor}}class a extends Phaser.GameObjects.Image{constructor(e,t,i,r){super(e,t,i,r),this.scene.add.existing(this),this.setInteractive()}activeButton(){this.active=!0,this.visible=!0}deactivateButton(){this.active=!1,this.visible=!1}}var o=i(439);class l extends Phaser.GameObjects.Rectangle{constructor(e,t,i,r,s,a,o,l){super(e,t,i,s,a,o,l),this.numberOfColor=r,this.setOrigin(0,0)}getTextOfTile(){return this.textOfTile}getNumberOfColor(){return this.numberOfColor}setTextOfTile(e){this.textOfTile=e}setNumberOfColor(e){this.numberOfColor=e}}class h extends l{constructor(e,t,i,r,s,a,o,l,h){super(e,t,i,0,s,a,16777215,l),this.setOrigin(0,0),this.createImageBoom(h),this.createCricle(),this.setInteractive()}createCricle(){this.cricleOfBoom=this.scene.add.graphics(),this.cricleOfBoom.lineStyle(10,0),this.cricleOfBoom.beginPath(),this.cricleOfBoom.arc(this.x+65,this.y+90,100,Phaser.Math.DegToRad(0),Phaser.Math.DegToRad(360),!0,.02).setDepth(3),this.cricleOfBoom.strokePath(),this.cricleOfBoom.closePath(),this.activeBoom(),this.deactiveBoom()}activeBoom(){this.strokeCricleOfBoom&&this.strokeCricleOfBoom.clear(),this.strokeCricleOfBoom=this.scene.add.graphics(),this.strokeCricleOfBoom.lineStyle(15,10027263),this.strokeCricleOfBoom.beginPath(),this.strokeCricleOfBoom.arc(this.x+65,this.y+90,110,Phaser.Math.DegToRad(0),Phaser.Math.DegToRad(360),!0,.02).setDepth(3),this.strokeCricleOfBoom.strokePath(),this.strokeCricleOfBoom.closePath()}deactiveBoom(){this.strokeCricleOfBoom.destroy()}createImageBoom(e){this.imageBoom=new Phaser.GameObjects.Image(this.scene,this.x,this.y,e).setOrigin(0,0).setDepth(2).setScale(.6),this.scene.add.existing(this.imageBoom)}scrollX(e){0!=e&&(this.deactiveBoom(),this.cricleOfBoom.x+=e,this.imageBoom.x+=e,this.x+=e)}}class n extends l{constructor(e,t,i,r,s,a,o,l){super(e,t,i,r,s,a,o,l),this.totalTile=0,this.totalTileMatch=0,this.setOrigin(0,0),this.createLoadingGrapic(),this.createProgressGrapic(),this.createImageSuccess()}createImageSuccess(){this.imageSuccess=new Phaser.GameObjects.Image(this.scene,this.x+this.width/2,this.y+this.height/2,"success").setDepth(4).setScale(.25),this.scene.add.existing(this.imageSuccess),this.imageSuccess.visible=!1}createProgressGrapic(){this.progressGrapic=this.scene.add.graphics(),this.progressGrapic.clear(),this.fillColor>12303291?this.progressGrapic.fillStyle(0,1):this.progressGrapic.fillStyle(16777215,1),this.progressGrapic.fillRoundedRect(this.x+19,this.y+110,108,14,6).setDepth(3),this.progressGrapic.visible=!1}createLoadingGrapic(){this.loadingGrapic=this.scene.add.graphics()}updateLoadingGrapic(){}createTextOfTile(){this.setTextOfTile(new Phaser.GameObjects.BitmapText(this.scene,this.x+this.width/2,this.y+this.height/2+25,"gothic",this.getNumberOfColor().toString(),50).setDepth(2).setOrigin(.5,1)),this.editColorText(),this.scene.add.existing(this.getTextOfTile())}editColorText(){this.fillColor>12303291?this.getTextOfTile().tint=0:this.getTextOfTile().tint=16777215}scrollX(e){this.imageSuccess.x+=e,this.getTextOfTile().x+=e,this.loadingGrapic.x+=e,this.progressGrapic.x+=e,this.x+=e}getProgressGraphic(){return this.progressGrapic}getLoadingGraphic(){return this.loadingGrapic}setTotalTile(e){this.totalTile=e}handleLoading(e){this.totalTileMatch+=1,this.loadingGrapic.clear(),this.fillColor<12303291?this.loadingGrapic.fillStyle(0,1):this.loadingGrapic.fillStyle(16777215,1);let t=this.totalTileMatch/this.totalTile,i=725*Math.ceil((e+1)/10);this.loadingGrapic.fillRoundedRect(this.x+25+i,this.y+113,95*t,7.5,4).setDepth(4),this.totalTileMatch==this.totalTile&&this.addEffect()}addEffect(){this.scene.tweens.add({targets:this,duration:300,scale:{from:1,to:.7},onStart:()=>{this.x+=this.width/2,this.y+=this.height/2,this.setOrigin(.5,.5),this.loadingGrapic.clear(),this.progressGrapic.clear()},onComplete:(e,t)=>{this.getTextOfTile().destroy(),this.scene.add.tween({targets:this,duration:100,yoyo:!0,angle:{from:-15,to:15},repeat:3,onComplete:()=>{this.angle=0}}),this.scene.tweens.add({targets:this,delay:800,duration:250,scale:{from:.7,to:1},onComplete:()=>{this.imageSuccess.visible=!0,this.active=!1,this.removeInteractive()}})}})}}class c extends Phaser.GameObjects.Rectangle{constructor(e,t,i,r,s,a,o,l,h){super(e,r,s,a+725,o,16777215,h),this.isScroll=!1,this.stateTileBoom=!1,this.stateMagicWand=!1,this.arrayColor=t,this.totalTileOfColor=i,this.setOrigin(0,0),this.setInteractive(),this.createTile(),this.createLineOfTable(),this.createScroller(),this.setFirstCurrentTile(),this.inputHandler(),this.createStateOfPage(),e.add.existing(this)}createStateOfPage(){let e=Math.ceil(this.arrayTile.length/10)+1;this.stateOfpage=new Array(e),this.stateOfpage[0]=this.scene.add.image(this.scene.sys.canvas.width/2-12*e,this.scene.sys.canvas.height-60,"star").setScale(.04).setDepth(2);for(let e=1;e<this.stateOfpage.length;e++)this.stateOfpage[e]=this.scene.add.image(this.stateOfpage[e-1].x+30,this.scene.sys.canvas.height-58,"cricle").setScale(.015).setDepth(2);this.currentStateOfpage=this.stateOfpage[1],this.currentStateOfpage.setTint(4473924)}createLineOfTable(){this.scene.add.line(this.x,this.y-1,0,0,1e5,0,0),this.lineBetweenTool=this.scene.add.line(this.x+724,this.y+143,this.x,0,this.x,290,0).setDepth(1)}setFirstCurrentTile(){this.currentTile=this.arrayTile[0],this.currentTile.getTextOfTile().setFontSize(65),this.currentTile.getProgressGraphic().visible=!0,this.currentTile.getLoadingGraphic().visible=!0,this.scene.registry.set("currentTile",this.currentTile)}createTile(){this.arrayTile=new Array;let e=0,t=0;for(let i=0;i<this.arrayColor.length;i++)i%5==0&&0!=i&&(i%10!=0&&(t-=5),e=0==e?1:0),this.arrayTile[i]=new n(this.scene,145*t+this.x+725,145*e+this.y,i,145,145,this.arrayColor[i]).setDepth(1),this.arrayTile[i].setTotalTile(this.totalTileOfColor[i]),this.arrayTile[i].setInteractive().createTextOfTile(),this.scene.add.existing(this.arrayTile[i]),t++;this.createItem()}createItem(){this.tileBoom=new h(this.scene,430,1090,0,180,180,0,1,"boom").setDepth(1),this.scene.add.existing(this.tileBoom),this.tileMagicWand=new h(this.scene,140,1090,0,180,180,0,1,"dua").setDepth(1),this.scene.add.existing(this.tileMagicWand)}createScroller(){this.lastScroller=-725;let e=Math.ceil(this.arrayColor.length/10);this.scroller=new o.Z(this,{bounds:[725*-e,0],value:-725,slidingDeceleration:1e9,backDeceleration:1e4,orientation:"horizontal",valuechangeCallback:e=>{if(e>0)return;let t=e-this.x;this.x=e,this.lineBetweenTool.x+=t,this.tileBoom.scrollX(t),this.tileMagicWand.scrollX(t);for(let e=0;e<this.getArrayTile().length;e++)this.getArrayTile()[e].scrollX(t)}}),this.dragstartScroller(),this.dragendScroller()}dragstartScroller(){this.scroller.on("dragstart",(()=>{this.isScroll=!0}))}dragendScroller(){let e=Math.ceil(this.arrayColor.length/10);this.scroller.on("dragend",(()=>{this.isScroll=!1;let t=this.scroller.value,i=0;t<725&&t>0||t<725*-e||(i=t>this.lastScroller?725*Math.ceil(t/725):725*-Math.ceil(-t/725),this.tileBoom.deactiveBoom(),this.tileMagicWand.deactiveBoom(),this.stateTileBoom&&(this.stateTileBoom=!1,this.scene.registry.set("tileboom",!1)),this.stateMagicWand&&(this.stateMagicWand=!1,this.scene.registry.set("tilemagicwand",!1)),this.scrollOnePage(t,i))}))}scrollOnePage(e,t){this.scene.tweens.addCounter({duration:150,from:e,to:t,onUpdate:e=>{let t=e.getValue()-this.x;this.lineBetweenTool.x+=t,this.x=e.getValue(),this.tileBoom.scrollX(t),this.tileMagicWand.scrollX(t);for(let e=0;e<this.getArrayTile().length;e++)this.getArrayTile()[e].scrollX(t)},onComplete:(e,i)=>{this.lastScroller=t,this.scroller.value=this.lastScroller}}),this.editStateOfPage(t)}editStateOfPage(e){let t=-1*e/725;this.currentStateOfpage.clearTint(),this.currentStateOfpage=this.stateOfpage[t].setTint(4473924)}getArrayTile(){return this.arrayTile}getCurrentTile(){return this.currentTile}inputHandler(){this.arrayTile.forEach(((e,t,i)=>{e.on("pointerup",((t,i,r,s)=>{this.isScroll||(this.currentTile.getTextOfTile().setFontSize(50),this.currentTile.getProgressGraphic().visible=!1,this.currentTile.getLoadingGraphic().visible=!1,e.getTextOfTile().setFontSize(60),e.getProgressGraphic().visible=!0,e.getLoadingGraphic().visible=!0,this.currentTile=e,this.scene.registry.set("currentTile",this.currentTile))}))})),this.tileBoom.on("pointerup",(()=>{this.stateTileBoom=!0,this.tileBoom.activeBoom(),this.tileMagicWand.deactiveBoom(),this.scene.registry.set("tileboom",!0),this.scene.registry.set("tilemagicwand",!1)})),this.tileMagicWand.on("pointerup",(()=>{this.stateMagicWand=!0,this.tileMagicWand.activeBoom(),this.tileBoom.deactiveBoom(),this.scene.registry.set("tileboom",!1),this.scene.registry.set("tilemagicwand",!0)}))}handleAfterMatch(){let e=this.currentTile.getNumberOfColor();this.arrayTile[e].handleLoading(e)}handleUsingBoom(){}}class g extends Phaser.Scene{constructor(){super({key:"ColorTableScene"}),this.currentMatchTile=0}preload(){}create(){let e=this.registry.get("level");console.log(e),this.colorManager=new s(this,e),this.registry.set("colorManager",this.colorManager);let t=Math.floor(this.colorManager.getArrayColor().length/10);this.colorTable=new c(this,this.colorManager.getArrayColor(),this.colorManager.getTotalTileOfColor(),0,1e3,725*(t+3),400),this.createButton(),this.inputHandler(),this.input.topOnly=!1}createButton(){this.registry.set("zoom",1);let e=this.add.zone(0,0,this.sys.canvas.width,this.sys.canvas.height).setOrigin(0,0);this.zoomButtonOut=new a(this,0,0,"zoomout").setScale(.12).setOrigin(1,0),Phaser.Display.Align.In.TopRight(this.zoomButtonOut,e,-50,-50),this.zoomButtonIn=new a(this,0,0,"zoomin").setScale(.45).setOrigin(1,0),Phaser.Display.Align.In.TopRight(this.zoomButtonIn,e,-35,-35),this.zoomButtonIn.deactivateButton(),this.buttonBackLevelScene=new a(this,0,0,"backlevel").setScale(.28),Phaser.Display.Align.In.TopLeft(this.buttonBackLevelScene,e,40,40)}inputHandler(){this.buttonBackLevelScene.on("pointerup",(()=>{this.scene.launch("LevelScene"),this.scene.stop("ColorTableScene"),this.scene.stop("GamePlayScene")})),this.zoomButtonOut.on("pointerup",(()=>{this.activeZoomButtonIn(),this.registry.set("zoomout",!1),this.registry.set("zoomin",!0),this.registry.set("clickzoom",!0)})),this.zoomButtonIn.on("pointerup",(()=>{this.activeZoomButtonOut(),this.registry.set("zoomout",!0),this.registry.set("zoomin",!1),this.registry.set("clickzoom",!0)}))}activeZoomButtonOut(){this.zoomButtonIn.deactivateButton(),this.zoomButtonOut.activeButton()}activeZoomButtonIn(){this.zoomButtonIn.activeButton(),this.zoomButtonOut.deactivateButton()}update(){this.registry.get("counterMatchTile")>this.currentMatchTile&&(1==this.registry.get("counterMatchTile")?(this.currentMatchTile+=1,this.colorTable.handleAfterMatch()):(this.currentMatchTile=this.registry.get("counterMatchTile"),this.colorTable.handleUsingBoom())),this.registry.get("zoomout")&&this.activeZoomButtonOut(),this.registry.get("zoomin")&&this.activeZoomButtonIn(),this.registry.get("deactive")?(this.zoomButtonOut.removeInteractive(),this.zoomButtonIn.removeInteractive(),this.buttonBackLevelScene.removeInteractive()):(this.zoomButtonOut.setInteractive(),this.zoomButtonIn.setInteractive(),this.buttonBackLevelScene.setInteractive())}}class d extends Phaser.Scene{constructor(){super({key:"BootScene"})}preload(){this.cameras.main.setBackgroundColor(0),this.createLoadingGraphics(),this.load.on("progress",(e=>{this.progressBar.clear(),this.progressBar.fillStyle(8971347,1),this.progressBar.fillRect(this.cameras.main.width/4,this.cameras.main.height/2-16,this.cameras.main.width/2*e,16)}),this),this.load.on("complete",(()=>{this.progressBar.destroy(),this.loadingBar.destroy()}),this),this.load.pack("preload","./assets/pack.json","preload"),this.load.bitmapFont("gothic","https://raw.githubusercontent.com/rexrainbow/phaser3-rex-notes/master/assets/fonts/gothic.png","https://raw.githubusercontent.com/rexrainbow/phaser3-rex-notes/master/assets/fonts/gothic.xml")}update(){this.scene.start("LevelScene")}create(){}createLoadingGraphics(){this.loadingBar=this.add.graphics(),this.loadingBar.fillStyle(16777215,1),this.loadingBar.fillRect(this.cameras.main.width/4-2,this.cameras.main.height/2-18,this.cameras.main.width/2+4,20),this.progressBar=this.add.graphics()}}var u=i(244);class m extends l{constructor(e,t,i,r,s,a,o,l,h,n){super(e,t,i,r,o,l,h,n),this.matchedColor=!1,this.iswrongColor=!1,this.wrongColor=0,this.locationX=0,this.locationY=0,this.setOrigin(0,0),this.locationX=s,this.locationY=a}addNumberColor(e){if(e)return this.scene.add.existing(e),void this.setTextOfTile(e);this.setTextOfTile(new Phaser.GameObjects.BitmapText(this.scene,this.x+this.width/2,this.y+this.height/2,"gothic",this.getNumberOfColor().toString(),this.width/2).setDepth(1).setOrigin(.5,.5)),this.getTextOfTile().tint=0,this.scene.add.existing(this.getTextOfTile())}editProperties(e=1){if(this.matchedColor)return this.strokeAlpha=0,void(this.fillAlpha=1);1==this.isWrongColor()&&(this.fillAlpha=1/e),e<=1.5?(this.strokeAlpha=0,this.getTextOfTile().alpha=0,this.fillAlpha=1/(3*e)):(this.fillAlpha=e>=3?0:1/(3*e),this.strokeAlpha=e/5,this.getTextOfTile().alpha=e/5)}afterMatchedColor(e){this.isStroked=!1,this.matchedColor=!0,this.fillAlpha=1,this.getTextOfTile().alpha=0,this.fillColor=e}editWrongColor(e,t){this.matchedColor||(this.iswrongColor=!0,this.fillColor=e,this.wrongColor=e,this.fillAlpha=1/t)}isWrongColor(){return this.iswrongColor}getWrongColor(){return this.wrongColor}isMatchedColor(){return this.matchedColor}setMatchedColor(){this.matchedColor=!0}}class f{constructor(e,t,i){this.totalTileGame=0,this.scene=e,this.imageGame=t.getImageGame(),this.colorManager=t,this.currentTile=i,this.createData(),this.showTile(1,this.currentTile)}createData(){this.row=Math.round(this.imageGame.width/1),this.column=Math.round(this.imageGame.height/1),this.createArrayTile(this.row,this.column)}createArrayTile(e,t){let i=Math.floor(725/this.imageGame.width),r=Math.floor(725/this.imageGame.height);this.arrayTile=new Array(e);for(let i=0;i<e;i++)this.arrayTile[i]=new Array(t);for(let s=0;s<e;s++)for(let e=0;e<t;e++){let t=this.scene.textures.getPixel(s,e,this.imageGame.texture.key);-1!=this.colorManager.getArrayColor().indexOf(t.color)&&(this.arrayTile[s][e]=new m(this.scene,s*i+15,e*r+200,this.colorManager.getArrayColor().indexOf(t.color),s,e,i,r,16777215),this.arrayTile[s][e].setInteractive(),this.arrayTile[s][e].addNumberColor(),this.arrayTile[s][e].setStrokeStyle(1,0))}}showTile(e=1,t){for(let i=0;i<this.arrayTile.length;i++)for(let r=0;r<this.arrayTile[0].length;r++){if(!this.arrayTile[i][r])continue;let s=this.colorManager.getColorAfterGrayScale(this.arrayTile[i][r].getNumberOfColor());this.scene.add.existing(this.arrayTile[i][r]).setOrigin(0,0),this.arrayTile[i][r].editProperties(e),this.arrayTile[i][r].getNumberOfColor()==t.getNumberOfColor()?this.arrayTile[i][r].fillColor=0:this.arrayTile[i][r].fillColor=s}}editAfterZoom(e=1,t){for(let i=0;i<this.arrayTile.length;i++)for(let r=0;r<this.arrayTile[0].length;r++)if(this.arrayTile[i][r]&&(this.arrayTile[i][r].editProperties(e),!this.arrayTile[i][r].isMatchedColor()&&(1==this.arrayTile[i][r].isWrongColor()&&(this.arrayTile[i][r].fillColor=this.arrayTile[i][r].getWrongColor()),this.arrayTile[i][r].getNumberOfColor()==t.getNumberOfColor()))){if(1==this.arrayTile[i][r].isWrongColor())continue;this.arrayTile[i][r].fillColor=0,this.arrayTile[i][r].fillAlpha=.3}}editAfterChooseColor(e,t){for(let i=0;i<this.arrayTile.length;i++)for(let r=0;r<this.arrayTile[0].length;r++){if(!this.arrayTile[i][r])continue;let s=this.colorManager.getColorAfterGrayScale(this.arrayTile[i][r].getNumberOfColor());this.arrayTile[i][r].editProperties(e),this.arrayTile[i][r].isMatchedColor()||(this.arrayTile[i][r].getNumberOfColor()==t.getNumberOfColor()?1==this.arrayTile[i][r].isWrongColor()?this.arrayTile[i][r].fillColor=this.colorManager.LightenDarkenColor(this.arrayTile[i][r].getWrongColor(),12):(this.arrayTile[i][r].fillColor=0,this.arrayTile[i][r].fillAlpha=.3):1==this.arrayTile[i][r].isWrongColor()?this.arrayTile[i][r].fillColor=this.arrayTile[i][r].getWrongColor():this.arrayTile[i][r].fillColor=s)}}getTotalTileGame(){let e=0;for(let t=0;t<this.arrayTile.length;t++)for(let i=0;i<this.arrayTile[0].length;i++)this.arrayTile[t][i]&&(e+=1);return e}getArrayTile(){return this.arrayTile}getCurrentTile(){return this.currentTile}setCurrentTile(e){this.currentTile=e}getTile(){for(let e=0;e<this.arrayTile.length;e++)for(let t=0;t<this.arrayTile[0].length;t++)if(this.arrayTile[e][t])return this.arrayTile[e][t];return new m(this.scene,0,0,0,0,725/this.imageGame.width,725/this.imageGame.width)}afterUsingBoom(e){let t=0,i=e.locationX,r=e.locationY,s=this.colorManager.getArrayColor()[this.arrayTile[i][r].getNumberOfColor()];0==e.isMatchedColor()&&(t+=1,this.arrayTile[i][r].afterMatchedColor(s));for(let e=0;e<this.arrayTile.length;e++)for(let s=0;s<this.arrayTile[0].length;s++)Math.sqrt((e-i)*(e-i)+(s-r)*(s-r))<=4.3&&this.checkMatchColor(e,s)&&(t+=1);return t}checkMatchColor(e,t){if(this.arrayTile[e][t]){let i=this.colorManager.getArrayColor()[this.arrayTile[e][t].getNumberOfColor()];return!this.arrayTile[e][t].isMatchedColor()&&(this.arrayTile[e][t].afterMatchedColor(i),!0)}return!1}afterUsingMagicWand(e){let t=new Array,i=0,r=e.locationX,s=e.locationY,a=this.colorManager.getArrayColor()[this.arrayTile[r][s].getNumberOfColor()];0==e.isMatchedColor()&&(i+=1,this.arrayTile[r][s].afterMatchedColor(a));for(let i=r-1;i<r+2;i++)for(let a=s-1;a<s+2;a++)this.arrayTile[i][a]&&Math.sqrt((i-r)*(i-r)+(a-s)*(a-s))<=1&&this.arrayTile[i][a].getNumberOfColor()==e.getNumberOfColor()&&t.push(this.arrayTile[i][a]);return console.log(t),i+this.breadthFistSearch(t)}breadthFistSearch(e){let t=0;for(;e.length>0;){let i=e.pop(),r=i.locationX,s=i.locationY,a=this.colorManager.getArrayColor()[this.arrayTile[r][s].getNumberOfColor()];0==i.isMatchedColor()&&(t+=1,this.arrayTile[r][s].afterMatchedColor(a));for(let t=r-1;t<r+2;t++)for(let a=s-1;a<s+2;a++)Math.sqrt((t-r)*(t-r)+(a-s)*(a-s))<=1&&this.arrayTile[t][a]&&this.arrayTile[t][a].getNumberOfColor()==i.getNumberOfColor()&&0==this.arrayTile[t][a].isMatchedColor()&&e.push(this.arrayTile[t][a])}return t}}var p=i(754);class T extends Phaser.Scene{constructor(){super({key:"GamePlayScene"}),this.counterMatchTile=0,this.stateZoom=1,this.isMoveCamera=!1,this.numberOfMove=!1,this.isColoringUp=!1,this.isColoringMove=!1,this.nearestPointerUp=!1,this.counterPointerDown=0}preload(){}create(){this.counterMatchTile=0,this.scene.bringToTop("ColorTableScene"),this.colorManager=this.registry.get("colorManager"),this.currentTile=this.registry.get("currentTile"),this.tileGameManager=new f(this,this.colorManager,this.currentTile),this.registry.set("tileGameManager",this.tileGameManager),this.cameras.main.setOrigin(.5,.5),this.cameras.main.setZoom(1),this.setBoundCamera(),this.createDragScale(),this.inputHandler()}createDragScale(){let e=new p.aj(this,{enable:!0});this.createDragGame(e),this.createPinchGame(e)}createDragGame(e){let t=this.cameras.main.setZoom(1);e.on("drag1",(e=>{if(!this.isColoringMove){this.numberOfMove=!0;var i=e.drag1Vector;t.scrollX-=i.x/t.zoom,t.scrollY-=i.y/t.zoom,this.isMoveCamera=!0,this.registry.set("deactive",!0)}})),e.on("drag1end",(()=>{this.isMoveCamera=!1,this.registry.set("deactive",!1)}),this)}createPinchGame(e){let t=this.cameras.main.setZoom(1);e.on("pinch",(e=>{if(this.isColoringUp)return;this.registry.set("deactive",!0);let i=e.scaleFactor;this.handleZoomCamera(t,i)}),this),e.on("pinchend",(e=>{this.registry.set("deactive",!1),this.isColoringMove=!1,this.isMoveCamera=!1}),this)}handleZoomCamera(e,t){if(this.colorManager.getImageGame().height>60){if(e.zoom*t>=8)return e.zoom=8,this.setBoundCamera(),void this.buttonFollowCameraZoom(e)}else if(e.zoom*t>=5)return e.zoom=5,this.setBoundCamera(),void this.buttonFollowCameraZoom(e);if(e.zoom*t<=1)return e.zoom=1,this.setBoundCamera(),void this.buttonFollowCameraZoom(e);this.buttonFollowCameraZoom(e),this.numberOfMove=!0,this.isMoveCamera=!0,e.zoom*=t,this.tileGameManager.editAfterZoom(e.zoom,this.currentTile),this.setBoundCamera()}buttonFollowCameraZoom(e){e.zoom>=3?(this.registry.set("zoomout",!1),this.registry.set("zoomin",!0)):(this.registry.set("zoomout",!0),this.registry.set("zoomin",!1))}inputHandler(){this.tileGameManager.getArrayTile().forEach((e=>{e.forEach((e=>{this.handlePointerUpTile(e),this.handlePointerDownTile(e)}))})),this.input.on("pointerdown",(()=>{if(this.isColoringMove)return this.isColoringMove=!1,void(this.isColoringUp=!1);this.counterPointerDown+=1,this.nearestPointerUp=!1,this.time.addEvent({delay:30,callback:()=>{this.isMoveCamera||1!=this.counterPointerDown||(this.isColoringUp=!0),this.counterPointerDown=0}}),this.time.addEvent({delay:500,callback:()=>{this.nearestPointerUp?this.nearestPointerUp=!1:(this.isColoringUp&&!this.isMoveCamera&&(this.isColoringMove=!0),this.counterPointerDown=0)}})}))}handlePointerDownTile(e){e.on("pointermove",(t=>{if(t.isDown&&this.isColoringMove&&!this.isMoveCamera)if(this.numberOfMove)this.numberOfMove=!1;else if(this.registry.set("deactive",!0),e.getNumberOfColor()==this.currentTile.getNumberOfColor()&&0==e.isMatchedColor())e.afterMatchedColor(this.currentTile.fillColor),this.counterMatchTile+=1,this.registry.set("counterMatchTile",this.counterMatchTile),this.counterMatchTile==this.tileGameManager.getTotalTileGame()&&this.completeGame();else{let t=this.cameras.main.zoom;e.editWrongColor(this.currentTile.fillColor,t)}}))}handlePointerUpTile(e){e.on("pointerup",(t=>{if(this.nearestPointerUp=!0,this.isColoringMove=!1,this.registry.set("deactive",!1),this.numberOfMove)return this.numberOfMove=!1,void(this.isColoringUp=!1);if(this.isColoringUp){if(this.isColoringUp=!1,this.registry.get("tileboom")){let t=this.tileGameManager.afterUsingBoom(e);return this.counterMatchTile+=t,this.registry.set("counterMatchTile",this.counterMatchTile),this.registry.set("tileboom",!1),void(this.counterMatchTile==this.tileGameManager.getTotalTileGame()&&this.completeGame())}if(this.registry.get("tilemagicwand")){let t=this.tileGameManager.afterUsingMagicWand(e);return this.counterMatchTile+=t,this.registry.set("counterMatchTile",this.counterMatchTile),this.registry.set("tilemagicwand",!1),void(this.counterMatchTile==this.tileGameManager.getTotalTileGame()&&this.completeGame())}if(e.getNumberOfColor()==this.currentTile.getNumberOfColor()&&0==e.isMatchedColor())e.afterMatchedColor(this.currentTile.fillColor),this.counterMatchTile+=1,this.registry.set("counterMatchTile",this.counterMatchTile),this.colorManager.getImageGame(),this.counterMatchTile==this.tileGameManager.getTotalTileGame()&&this.completeGame();else{let t=this.cameras.main.zoom;e.editWrongColor(this.currentTile.fillColor,t)}}}))}update(){if(this.currentTile=this.registry.get("currentTile"),this.currentTile!=this.tileGameManager.getCurrentTile()){let e=this.cameras.main.zoom;this.tileGameManager.editAfterChooseColor(e,this.currentTile),this.tileGameManager.setCurrentTile(this.currentTile)}if(this.registry.get("clickzoom")){this.registry.set("clickzoom",!1);let e=this.registry.get("zoomin")?3:1;this.add.tween({targets:this,duration:300,zoom:{from:this.cameras.main.zoom,to:e},onUpdate:(e,t)=>{this.cameras.main.zoom=t.zoom,this.setBoundCamera()}}),this.stateZoom=e,this.tileGameManager.editAfterZoom(this.stateZoom,this.currentTile)}}setBoundCamera(){this.cameras.main.setBounds(-120,0,935,1225)}completeGame(){this.add.tween({targets:this,a:0,delay:300,duration:2e3,onStart:()=>{this.add.tween({targets:this,duration:200,zoom:{from:this.cameras.main.zoom,to:1},onUpdate:(e,t)=>{this.cameras.main.zoom=t.zoom,this.setBoundCamera()}})},onComplete:()=>{this.scene.start("OverScene",{tileGameManager:this.tileGameManager,colorManager:this.colorManager}),this.scene.stop("GamePlayScene"),this.scene.stop("ColorTableScene")}})}}class y extends Phaser.GameObjects.Rectangle{constructor(e,t,i,r,s,a,o){super(e,t,i,r,s,a),this.createImageLevel(o),this.nameOfLevel=o,this.imageLevel.setDepth(2)}createImageLevel(e){this.imageLevel=this.scene.add.image(this.x+this.width/2,this.y+this.height/2,e),this.imageLevel.setPipeline("Gray"),this.imageLevel.displayWidth=250,this.imageLevel.displayHeight=250,this.imageLevel.texture.setFilter(1),this.imageLevel.visible=!1}activeLevel(){this.imageLevel.visible=!0}deActiveLevel(){this.imageLevel.visible=!1}getNameOfLevel(){return this.nameOfLevel}scrollY(e){this.imageLevel.y+=e,this.y+=e}}class v extends Phaser.GameObjects.Rectangle{constructor(e,t,i,r,s,a){super(e,t,i,r,s,a),this.isScroll=!1,this.createLevel(),this.setOrigin(0,0),this.setDepth(0),this.setInteractive(),this.createScroll(),this.inputHandler()}createScroll(){this.lastScroller=200,Math.ceil(this.level.length/6),this.scroller=new o.Z(this,{bounds:[-7970,200],value:200,slidingDeceleration:1e7,backDeceleration:1e4,orientation:"vertical",valuechangeCallback:e=>{let t=e-this.y;this.y=e;for(let e=1;e<this.level.length;e++)this.level[e].scrollY(t),this.level[e].y<190?this.level[e].removeInteractive():this.level[e].setInteractive()}}),this.dragstartScroller(),this.dragendScroller()}dragstartScroller(){this.scroller.on("dragstart",(()=>{this.isScroll=!0}))}dragendScroller(){this.scroller.on("dragend",(()=>{this.isScroll=!1;let e=this.scroller.value,t=0;e>200||e<-7970||(t=e>this.lastScroller?e>-830?200:1020*Math.ceil(e/1020)+190:e<200&&e>-830?-830:1020*-Math.ceil(-e/1020)-830,this.scrollOnePage(e,t))}))}scrollOnePage(e,t){this.scene.tweens.addCounter({duration:150,from:e,to:t,onUpdate:e=>{let t=e.getValue()-this.y;this.y=e.getValue();for(let e=1;e<this.level.length;e++)this.level[e].scrollY(t)},onComplete:(e,i)=>{this.lastScroller=t,this.scroller.value=this.lastScroller}})}createLevel(){this.level=new Array;let e=0,t="level";for(let i=1;i<50;i+=2)this.level[i]=new y(this.scene,this.x+35,this.y+20+340*e,320,320,-1,t+i),this.level[i+1]=new y(this.scene,this.x+370,this.y+20+340*e,320,320,-1,t+(i+1)),this.level[i].setOrigin(0,0).setDepth(1),this.scene.add.existing(this.level[i]),this.level[i].visible=!1,this.level[i+1].visible=!1,this.level[i+1].setOrigin(0,0).setDepth(1),this.scene.add.existing(this.level[i+1]),this.level[i].setInteractive(),this.level[i+1].setInteractive(),e++}activePage(){this.level.forEach((e=>{e.visible=!0,e.activeLevel()}))}deactivePage(){this.level.forEach((e=>{e.visible=!1,e.deActiveLevel()}))}inputHandler(){this.level.forEach(((e,t,i)=>{e.on("pointerup",(()=>{this.isScroll||(this.scene.registry.set("level",e.getNameOfLevel()),this.scene.scene.start("ColorTableScene"),this.scene.scene.start("GamePlayScene"),this.scene.scene.pause("LevelScene"))}))}))}}class C extends Phaser.GameObjects.Rectangle{constructor(e,t,i,r,s,a,o){super(e,t,i,r,s,a),this.setOrigin(0,0),this.createText(o),e.add.existing(this),e.add.existing(this.textButton),this.setInteractive(),this.textButton.setDepth(3)}createText(e){this.textButton=new Phaser.GameObjects.BitmapText(this.scene,this.x+3*e.length,this.y+16,"gothic",e,32).setDepth(1),this.textButton.tint=3355443}activeButton(){this.textButton.tint=0}deactivateButton(){this.textButton.tint=3355443}}var b=i(742);class O extends Phaser.Scene{constructor(){super({key:"LevelScene"})}preload(){for(let e=1;e<6;e++);}create(){this.add.rectangle(0,0,725,200,16316671).setOrigin(0,0).setDepth(3),this.buttonLevelPage=new C(this,50,110,110,80,16316671,"Level").setDepth(3),this.buttonColoredPage=new C(this,200,110,150,80,16316671,"Colored").setDepth(3),this.buttonColoringPage=new C(this,380,110,180,80,16316671,"Coloring").setDepth(3),this.levelPage=new v(this,0,200,725,9400,14474460),this.pages=new b.iY(this,{x:0,y:200,width:725,height:1100,draggable:!0}),this.add.existing(this.pages),this.add.existing(this.levelPage),this.levelPage.visible=!1,this.pages.addPage(this.levelPage,{key:"0",align:Phaser.Display.Align.TOP_LEFT,padding:{left:0,right:0,top:0,bottom:0},expand:!0}),this.input.topOnly=!1,this.activePageLevel(),this.inputHandler()}inputHandler(){this.buttonLevelPage.on("pointerdown",(()=>{this.activePageLevel()})),this.buttonColoredPage.on("pointerdown",(()=>{this.pages.swapPage("1"),this.levelPage.deactivePage(),this.buttonLevelPage.deactivateButton(),this.buttonColoredPage.activeButton(),this.buttonColoringPage.deactivateButton()})),this.buttonColoringPage.on("pointerdown",(()=>{this.pages.swapPage("2"),this.levelPage.deactivePage(),this.buttonLevelPage.deactivateButton(),this.buttonColoredPage.deactivateButton(),this.buttonColoringPage.activeButton()}))}activePageLevel(){this.pages.swapPage("0"),this.levelPage.activePage(),this.buttonLevelPage.activeButton(),this.buttonColoredPage.deactivateButton(),this.buttonColoringPage.deactivateButton()}update(){}}const{Between:M,FloatBetween:x,RadToDeg:B}=Phaser.Math,{GetRandom:P}=Phaser.Utils.Array;class w extends Phaser.Scene{constructor(){super({key:"OverScene"})}init(e){this.tileGameManager=e.tileGameManager,this.colorManager=e.colorManager,this.textures.generate("rocket",{data:["0123..."],palette:{0:"#fff2",1:"#fff4",2:"#fff8",3:"#ffff",4:"#fff2",5:"#fff4",6:"#fff8",7:"#ffff",8:"#fff2",9:"#fff4",A:"#fff8",B:"#ffff",C:"#fff2",D:"#fff4",E:"#fff8",F:"#ffff"},pixelWidth:4})}create(){this.textCongrats=new Phaser.GameObjects.Text(this,360,120,"Bạn cừ lắm!",{fontFamily:"Caroni",fontSize:"50px",color:"#000000"}).setDepth(1).setOrigin(.5,.5),this.textCongrats.tint=0,this.add.existing(this.textCongrats);let e=0,t=this.colorManager.getArrayColor(),i=this.tileGameManager.getTile();for(let r=0;r<t.length;r++){let s=Phaser.Math.Between(10,1500);this.tileGameManager.getArrayTile().forEach(((a,o)=>{a.forEach(((a,l)=>{if(t[r]==this.colorManager.getArrayColor()[a.getNumberOfColor()]){let a=new m(this,o*i.width+15,l*i.height+200,0,o,l,i.width,i.height,t[r]);this.add.tween({targets:a,duration:s,a:0,onComplete:()=>{this.add.existing(a)}}),s>2e3?(s+=15,s>3e3&&(s-=10)):s+=20,s>e&&(e=s)}}))}))}this.buttonNextLevel=new a(this,370,1100,"nextlevel"),this.buttonNextLevel.deactivateButton(),this.add.tween({targets:this.buttonNextLevel,duration:e,alpha:{from:0,to:1},onComplete:()=>{this.buttonNextLevel.activeButton(),this.addEffectButtonNext(),this.addEffectEndGame(),this.inputHandler()}})}addEffectEndGame(){let e={alpha:{start:1,end:0,ease:"Cubic.easeIn"},angle:{start:0,end:360,steps:100},rotate:{onEmit:this.updateParticleRotation,onUpdate:this.updateParticleRotation},blendMode:"ADD",gravityY:128,lifespan:3e3,quantity:500,reserve:500,scaleX:{onUpdate:e=>Phaser.Math.Easing.Cubic.Out(1-e.lifeT)},speed:{min:128,max:256}},t=this.add.particles("rocket"),i=t.createEmitter(e).setFrequency(3e3),r=t.createEmitter(e).setFrequency(4e3),s=t.createEmitter(e).setFrequency(5e3);this.updateEmitter(i),this.updateEmitter(r),this.updateEmitter(s),this.time.addEvent({delay:i.frequency,repeat:-1,callback:()=>{this.updateEmitter(i)}}),this.time.addEvent({delay:r.frequency,repeat:-1,callback:()=>{this.updateEmitter(r)}}),this.time.addEvent({delay:s.frequency,repeat:-1,callback:()=>{this.updateEmitter(s)}})}addEffectButtonNext(){this.add.tween({targets:this.buttonNextLevel,duration:400,scale:{from:1,to:.9},repeat:-1,yoyo:!0})}inputHandler(){this.buttonNextLevel.on("pointerup",(()=>{let e=this.registry.get("level"),t=0,i="";for(let t=5;t<e.length;t++)i+=e[t];t=parseInt(i),this.registry.set("level","level"+(t+1).toString()),this.scene.start("ColorTableScene"),this.scene.start("GamePlayScene"),this.scene.stop("OverScene")}))}update(){}updateEmitter(e){for(var t="0123456789ABCDEF",i=t[Math.floor(16*Math.random())],r=0;r<6;r++)i+=t[Math.floor(16*Math.random())];e.setPosition(725*x(.25,.75),768*x(0,.5)).setTint(parseInt(i,16))}updateParticleRotation(e){return B(Math.atan2(e.velocityY,e.velocityX))}}const G={title:"Pixel Art - Color By Number:",version:"1.0.0",width:725,height:1394,zoom:1,type:Phaser.WEBGL,backgroundColor:"#F8F8FF",plugins:{global:[{key:"rexScroller",plugin:u.Z,start:!0}]},scale:{mode:Phaser.Scale.FIT,autoCenter:Phaser.Scale.CENTER_BOTH},parent:"game",input:{keyboard:!0,mouse:!0,touch:{capture:!0}},disableContextMenu:!0,physics:{default:"arcade",arcade:{debug:!1}},scene:[d,O,g,T,w]};class S extends Phaser.Game{constructor(e){super(e),this.renderer.pipelines.add("Gray",new r(this))}}window.addEventListener("load",(()=>{new S(G)}))},204:()=>{console.log("%c %c %c %c %c Built using phaser-project-template %c https://github.com/yandeu/phaser-project-template","background: #ff0000","background: #ffff00","background: #00ff00","background: #00ffff","color: #fff; background: #000000;","background: none")}},i={};function r(e){var s=i[e];if(void 0!==s)return s.exports;var a=i[e]={exports:{}};return t[e].call(a.exports,a,a.exports,r),a.exports}r.m=t,e=[],r.O=(t,i,s,a)=>{if(!i){var o=1/0;for(c=0;c<e.length;c++){for(var[i,s,a]=e[c],l=!0,h=0;h<i.length;h++)(!1&a||o>=a)&&Object.keys(r.O).every((e=>r.O[e](i[h])))?i.splice(h--,1):(l=!1,a<o&&(o=a));if(l){e.splice(c--,1);var n=s();void 0!==n&&(t=n)}}return t}a=a||0;for(var c=e.length;c>0&&e[c-1][2]>a;c--)e[c]=e[c-1];e[c]=[i,s,a]},r.d=(e,t)=>{for(var i in t)r.o(t,i)&&!r.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={179:0};r.O.j=t=>0===e[t];var t=(t,i)=>{var s,a,[o,l,h]=i,n=0;if(o.some((t=>0!==e[t]))){for(s in l)r.o(l,s)&&(r.m[s]=l[s]);if(h)var c=h(r)}for(t&&t(i);n<o.length;n++)a=o[n],r.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return r.O(c)},i=self.webpackChunkphaser_project_template=self.webpackChunkphaser_project_template||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))})(),r.O(void 0,[216],(()=>r(843)));var s=r.O(void 0,[216],(()=>r(204)));s=r.O(s)})();